----------------------------------------------
--------- transacciones ----------------------
----------------------------------------------
select  
FECHA_TRANSACCION	,	
b.ano anio,
b.anomes anio_mes,
b.mes_nombre,
b.dia_mes,
HORA_TRANSACCION	,	
round(SK_CLIENTE*3.5,0)	Numero_LLave_origen,	
round(SK_CLIENTE_DESTINO*3.5,0)	Numero_LLave_destino,	
SK_RANGO_ANTIGUEDAD_CLIENTE	,	
SK_RANGO_EDAD	,	
SK_TRANSACCION_CANAL	,	
SK_EMPLEADO_DPD	,	
SK_COLECTORES	,	
SK_TARJETA_PROPIA	,	
'11111' SK_REFERENCIA_TARJETA	,	
'11111' SK_REFERENCIA_CUENTA_ORIGEN	,	
'11111' SK_REFERENCIA_CUENTA_DESTINO	,	
SK_NATURALEZA	,	
SK_DISPOSITIVOS	,	
MONTO	,	
CANTIDAD	,	
MONTO_MONETARIO	,	
MONTO_NO_MONETARIO	,	
MONTO_CREDITO	,	
MONTO_DEBITOS	,	
CANTIDAD_CREDITO	,	
CANTIDAD_DEBITO	,	
FECHAMES	,	
ES_MONETARIA	,	
SK_PRODUCTO_AGRUPADO	,	
SK_PRODUCTO_ORIGEN	,	
SK_PRODUCTO_DESTINO	,	
COMPROBANTE	,	
SK_COMPANIA_TELEFONICA	,	
ID_TRANSACTION	,	
NUMERO_CELULAR	,	
SK_PRODUCTO_TARJETA	,	
SK_REMESADORA		
from
DMTRANSCANALES.F_TRANSACCION_CANALES_DIARIA a left join DMDIMENSIONES.D_FECHA b
on a.FECHA_TRANSACCION = b.PERIODO
where b.ano >= 2015 and sk_cliente_destino <> 0

;

----------------------------------------------
--------- Clientes ---------------------------
----------------------------------------------

select 
FACT_CLIENTE	,
b.ano anio,
b.anomes anio_mes,
b.mes_nombre,
b.dia_mes,
round(SK_CLIENTE,3.5) Numero_LLave	,
round(SK_MASTER,3.5)	Numero_Grupo_Economico,
SK_RELACION_COMERCIAL	,
BK_RELACION_COMERCIAL	,
BD_RELACION_COMERCIAL	,
FLAG_VALOR_RELACION	,
EJECUTIVO_TRANSVERSAL	,
CIFSEGMENT_EST	,
SK_TIPO_CLIENTE	,
BK_TIPO_CLIENTE	,
BD_TIPO_CLIENTE	,
FCRE_CLIENTE	,
FECHA_FLAG_RES_ALTO_RIESGO	,
FECHA_FLAG_DESERCION	,
FECHA_PRIMER_INICIO_OPERACION	,
FECHA_NACIMIENTO	,
TEMPORALIDAD_TRABAJO_GR	,
LUGAR_TRABAJO_CLIENTE_GR	,
SK_PAIS_RESIDENCIA	,
BK_PAIS_RESIDENCIA	,
BD_PAIS_RESIDENCIA	,
SK_GENERO	,
BK_GENERO	,
BD_GENERO	,
SK_OCUPACION	,
BK_OCUPACION	,
BD_OCUPACION	,
SK_PROFESION	,
BK_PROFESION	,
BD_PROFESION	,
SK_NIVEL_EDUCATIVO	,
BK_NIVEL_EDUCATIVO	,
BD_NIVEL_EDUCATIVO	,
SK_ESTADO_CIVIL	,
BK_ESTADO_CIVIL	,
BD_ESTADO_CIVIL	,
SK_NIVEL_INGRESO	,
BK_NIVEL_INGRESO	,
BD_NIVEL_INGRESO	,
SK_STATUS_CLIENTE	,
BK_STATUS_CLIENTE	,
BD_STATUS_CLIENTE	,
SK_AREA_FINANCIERA	,
BK_AREA_FINANCIERA	,
SK_SEGMENTO	,
BK_SEGMENTO	,
SK_ACTIVIDAD_ECONOMICA	,
BK_ACTIVIDAD_ECONOMICA	,
BD_ACTIVIDAD_ECONOMICA	,
SK_NACIONALIDAD	,
BK_NACIONALIDAD	,
BD_NACIONALIDAD	,
SK_CATEGORIA_RIESGO_SSF	,
BK_CATEGORIA_RIESGO_SSF	,
BD_CATEGORIA_RIESGO_SSF	,
SK_AGENTE_RETENCION	,
BK_AGENTE_RETENCION	,
BD_AGENTE_RETENCION	,
SK_CALIFICACION_RIESGO_RA	,
BK_CALIFICACION_RIESGO_RA	,
BD_CALIFICACION_RIESGO_RA	,
SK_RANGO_EDAD	,
BK_RANGO_EDAD	,
BD_RANGO_EDAD	,
SK_RANGO_ANTIGUEDAD_CLIENTE	,
BK_RANGO_ANTIGUEDAD_CLIENTE	,
BD_RANGO_ANTIGUEDAD_CLIENTE	,
SK_CATEGORIA_CVI	,
BK_CATEGORIA_CVI	,
BD_CATEGORIA_CVI	,
SK_RELACION_SALARIAL	,
BK_RELACION_SALARIAL	,
BD_RELACION_SALARIAL	
from DMDIMENSIONES.D_CLIENTE a left join DMDIMENSIONES.D_FECHA b
on a.FACT_CLIENTE = b.PERIODO
where b.ano >= 2015
--where flag_con_refinanciamientos <> 0
;

----------------------------------------------
--------- Prestamos --------------------------
----------------------------------------------

SELECT 
round(col.cifcodcliente*3.5,0) Numero_LLave,
COL.COLFCHPROC ,
col.colcodproducto,
col.coldiasmor,
col.fincodriesgo,
COL.COLSISTEMA,
COLSIS.FINCODCARTERA,
C.FINCODAREAFIN,
C.FINDESAREAFIN,
COL.COLSALDO,
COL.COLMONTOMN,
COL.COLTASAN
FROM DWBA.coldocum@riesgodb  COL
--------------
LEFT JOIN
---------------
BACATALOG.CATSISTEMAS@riesgodb COLSIS
ON COLSIS.COLCODAPLICATIVO = COL.COLSIS AND COLSIS.COLCODSISTEMA = COL.COLSISTEMA
--------------
LEFT JOIN
---------------    
BACATALOG.CATAREAFINANC@riesgodb C
ON COL.COLCODAREAFIN = C.FINCODAREAFIN
where (COLSIS.FINCODCARTERA IN (1, 61, 5, 201)) AND COL.COLFCHPROC >= ('31-ene-2012') ---and rownum <=10
union all
SELECT 
round(TAR.TARcodcliente1*3.5,0),
TAR.TARFCHPROC ,
TAR.TARcodproducto,
TAR.TARDIASMORDOL ,
TARcodriesgo,
TARSISTEMA,
case when TAR.TARTIPOSALDO = 3 then 5 else 1 end TARTIPOSALDO ,
C.FINCODAREAFIN,
C.FINDESAREAFIN,
TAR.TARSALDOCAPITAL,
tar.tarlimitedol,
tartasaefectiva
FROM DWBA.coltarjetas@riesgodb TAR
--------------
--------------
LEFT JOIN
---------------    
BACATALOG.CATAREAFINANC@riesgodb C
ON TAR.TARCODAREAFIN = C.FINCODAREAFIN
where TAR.TARCOD_BANCO <> 00061 AND TAR.TARFCHPROC >= ('31-ene-2012')
;







----------------------------------------------
--------- Depositos --------------------------
----------------------------------------------


select 
CAPFCHPROCESO	Fecha_Proceso,
11111111 numero_cuenta	,
round(CAPCODCLIENTE,3.5) Numero_LLave	,
CAPESTADOCUEN	 CAPESTADOCUEN,
CAPFCHEMISION	fecha_emision,
CAPFCHVENCIMI	fecha_vencimiento,
CAPPERIOCORTE	,
CAPTIPPERPAGO	,
CAPPERIOPAGOC	,
CAPFCHPROXPAG	,
CAPFCHULTIPAG	,
CAPTIPPERCALC	,
CAPPERIOCALCU	,
CAPCODAREA	,
CAPMONAPERTUR	monto_apertura,
CAPSALDACTUAL	saldo_Acutal,
CAPMONPIGNORA	saldo_pignorado,
CAPMONSOBREG1	monto_sobregiro,
CAPTASAACTUAL	,
CAPINTERESES	,
CAPINTPORPAGO	,
CAPINTPORPROV	,
CAPTASAREAL	tasa,
CAPAGRUPADOR	,
CAPCODCLASIFI	,
CAPCODTASA	,
CAPULTSALPRO	,
CAPCAPTADOR	,
CAPFLAGMADRE	,
CAPMONCHOYEX	,
CAPMONCOMPENSEX	,
CAPTASAMARGEN	,
CAPTIPPERVENC	,
CAPCALICTA	,
CAPSALDOANT	,
CAPFCHCAMSAL	,
CAPTIPOANOCAL	,
CAPSALDODISPO	,
CAPSALDOMN	saldo_depositos_usar,
CAPCODSECBANC	,
CAPSALDPROMES	,
CAPSALDPROANO	
from DWBA.capcuentas@sigbd
where CAPFCHPROCESO >= ('31-ene-2012')



